import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o as i,c as p,b as n,d as s,e as t,a as e}from"./app-b96769ad.js";const c={},u=n("p",null,"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/start-with-ets-stage-0000001477980905-V2",-1),r=n("figure",null,[n("img",{src:"https://qiniu.waite.wang/202404271535958.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),d=n("blockquote",null,[n("p",null,"一个应用只能有一个 @EntryAbility，但可以有多个 @PageAbility。")],-1),k=n("h2",{id:"stage模型-目录结构",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#stage模型-目录结构","aria-hidden":"true"},"#"),s(" （Stage模型）目录结构")],-1),m=n("figure",null,[n("img",{src:"https://qiniu.waite.wang/202404181340550.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),b=n("li",null,"AppScope > app.json5：应用的全局配置信息。",-1),v=n("li",null,"src > main > ets：用于存放ArkTS源码。 src > main > ets > entryability：应用/服务的入口。",-1),h=n("li",null,"src > main > ets > pages：应用/服务包含的页面",-1),_=n("li",null,"src > main > resources：用于存放应用/服务所用到的资源文件，如图形、多媒体、字符串、布局文件等。关于资源文件，详见资源分类与访问。",-1),g={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2",target:"_blank",rel:"noopener noreferrer"},y=n("li",null,"build-profile.json5：当前的模块信息、编译信息配置项，包括buildOption、targets配置等。其中targets中可配置当前运行环境，默认为HarmonyOS。",-1),f=n("li",null,"hvigorfile.ts：模块级编译构建任务脚本，开发者可以自定义相关任务和代码实现。",-1),A=n("li",null,"oh_modules：用于存放三方库依赖信息。关于原npm工程适配ohpm操作，请参考历史工程迁移。",-1),q=n("li",null,"build-profile.json5：应用级配置信息，包括签名、产品配置等。",-1),w=n("li",null,"hvigorfile.ts：应用级编译构建任务脚本。",-1),I=n("h2",{id:"应用配置文件",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#应用配置文件","aria-hidden":"true"},"#"),s(" 应用配置文件")],-1),V=n("p",null,"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/14d_u7f6e_u6587_u4ef6_uff08stage_u6a21_u578b_uff09-0000001427902192-V2",-1),C=n("figure",null,[n("img",{src:"https://qiniu.waite.wang/202404271550809.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),E=n("blockquote",null,[n("p",null,"app.json5文件是应用的全局配置文件，用于配置应用的基本信息、版本信息、图标、名称、描述等。")],-1),U=n("thead",null,[n("tr",null,[n("th",null,"属性名称"),n("th",null,"含义"),n("th",null,"数据类型"),n("th",null,"是否可缺省")])],-1),x=n("tr",null,[n("td",null,"bundleName"),n("td",null,"标识应用的Bundle名称，用于标识应用的唯一性。该标签不可缺省。标签的值命名规则 ：- 字符串以字母、数字、下划线和符号“.”组成。- 以字母开头。- 最小长度7个字节，最大长度127个字节。推荐采用反域名形式命名（如com.example.demo，建议第一级为域名后缀com，第二级为厂商/个人名，第三级为应用名，也可以多级）。"),n("td",null,"字符串"),n("td",null,"该标签不可缺省。")],-1),P=n("tr",null,[n("td",null,"bundleType"),n("td",null,"标识应用的Bundle类型，用于区分应用或者原子化服务。该标签可选值为app和atomicService ：- app：当前Bundle为普通应用。- atomicService：当前Bundle为元服务。"),n("td",null,"字符串"),n("td",null,"该标签可以缺省，缺省为app。")],-1),j=n("tr",null,[n("td",null,"debug"),n("td",null,"标识应用是否可调试，该标签由IDE编译构建时生成。- true：可调试。- false：不可调试。"),n("td",null,"布尔值"),n("td",null,"该标签可以缺省，缺省为false。")],-1),T=n("td",null,"icon",-1),S={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/application-component-configuration-stage-0000001478340869-V2",target:"_blank",rel:"noopener noreferrer"},N=n("td",null,"字符串",-1),B=n("td",null,"该标签不可缺省。",-1),H=n("td",null,"label",-1),M={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/application-component-configuration-stage-0000001478340869-V2",target:"_blank",rel:"noopener noreferrer"},F=n("td",null,"字符串",-1),D=n("td",null,"该标签不可缺省。",-1),O=n("tr",null,[n("td",null,"description"),n("td",null,"标识应用的描述信息，标签值是字符串类型（最大255个字节）或对描述内容的字符串资源索引。"),n("td",null,"字符串"),n("td",null,"该标签可缺省，缺省值为空。")],-1),Z=n("tr",null,[n("td",null,"vendor"),n("td",null,"标识对应用开发厂商的描述。该标签的值是字符串类型（最大255个字节）。"),n("td",null,"字符串"),n("td",null,"该标签可以缺省，缺省为空。")],-1),K=n("tr",null,[n("td",null,"versionCode"),n("td",null,"标识应用的版本号，该标签值为32位非负整数。此数字仅用于确定某个版本是否比另一个版本更新，数值越大表示版本越高。开发者可以将该值设置为任何正整数，但是必须确保应用的新版本都使用比旧版本更大的值。该标签不可缺省，versionCode值应小于2^31次方。"),n("td",null,"数值"),n("td",null,"该标签不可缺省。")],-1),W=n("tr",null,[n("td",null,"versionName"),n("td",null,"标识应用版本号的文字描述，用于向用户展示。该标签仅由数字和点构成，推荐采用“A.B.C.D”四段式的形式。四段式推荐的含义如下所示。第一段：主版本号/Major，范围0-99，重大修改的版本，如实现新的大功能或重大变化。第二段：次版本号/Minor，范围0-99，表示实现较突出的特点，如新功能添加或大问题修复。第三段：特性版本号/Feature，范围0-99，标识规划的新版本特性。第四段：修订版本号/Patch，范围0-999，表示维护版本，修复bug。标签最大字节长度为127。"),n("td",null,"字符串"),n("td",null,"该标签不可缺省。")],-1),z=n("tr",null,[n("td",null,"minCompatibleVersionCode"),n("td",null,"标识应用能够兼容的最低历史版本号，用于跨设备兼容性判断。说明当前版本暂不支持跨设备能力。"),n("td",null,"数值"),n("td",null,"该标签可缺省，缺省值等于versionCode标签值。")],-1),$=n("tr",null,[n("td",null,"minAPIVersion"),n("td",null,"标识应用运行需要的SDK的API最小版本。"),n("td",null,"数值"),n("td",null,"由build-profile.json5中的compatibleSdkVersion生成。")],-1),R=n("tr",null,[n("td",null,"targetAPIVersion"),n("td",null,"标识应用运行需要的API目标版本。"),n("td",null,"数值"),n("td",null,"由build-profile.json5中的compileSdkVersion生成。")],-1),L=n("tr",null,[n("td",null,"apiReleaseType"),n("td",null,"标识应用运行需要的API目标版本的类型，采用字符串类型表示。取值为“CanaryN”、“BetaN”或者“Release”，其中，N代表大于零的整数。- Canary：受限发布的版本。- Beta：公开发布的Beta版本。- Release：公开发布的正式版本。该字段由DevEco Studio读取当前使用的SDK的Stage来生成。"),n("td",null,"字符串"),n("td",null,"该标签可缺省，由IDE生成并覆盖。")],-1),G=n("td",null,"multiProjects",-1),J={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/build_overview-0000001055075201-V2#section73401914284",target:"_blank",rel:"noopener noreferrer"},Q=n("td",null,"布尔值",-1),X=n("td",null,"可缺省，缺省值为false。",-1),Y=n("tr",null,[n("td",null,"tablet"),n("td",null,"标识对tablet设备做的特殊配置，可以配置的属性字段有上文提到的：minAPIVersion、distributedNotificationEnabled。如果使用该属性对tablet设备做了特殊配置，则应用在tablet设备中会采用此处配置的属性值，并忽略在app.json5公共区域配置的属性值。"),n("td",null,"对象"),n("td",null,"该标签可缺省，缺省时tablet设备使用app.json5公共区域配置的属性值。")],-1),nn=n("tr",null,[n("td",null,"tv"),n("td",null,"标识对tv设备做的特殊配置，可以配置的属性字段有上文提到的：minAPIVersion、distributedNotificationEnabled。如果使用该属性对tv设备做了特殊配置，则应用在tv设备中会采用此处配置的属性值，并忽略在app.json5公共区域配置的属性值。"),n("td",null,"对象"),n("td",null,"该标签可缺省，缺省时tv设备使用app.json5公共区域配置的属性值。")],-1),sn=n("tr",null,[n("td",null,"wearable"),n("td",null,"标识对wearable设备做的特殊配置，可以配置的属性字段有上文提到的：minAPIVersion、distributedNotificationEnabled。如果使用该属性对wearable设备做了特殊配置，则应用在wearable设备中会采用此处配置的属性值，并忽略在app.json5公共区域配置的属性值。"),n("td",null,"对象"),n("td",null,"该标签可缺省，缺省时wearable设备使用app.json5公共区域配置的属性值。")],-1),an=n("tr",null,[n("td",null,"car"),n("td",null,"标识对car设备做的特殊配置，可以配置的属性字段有上文提到的：minAPIVersion、distributedNotificationEnabled。如果使用该属性对car设备做了特殊配置，则应用在car设备中会采用此处配置的属性值，并忽略在app.json5公共区域配置的属性值。"),n("td",null,"对象"),n("td",null,"该标签可缺省，缺省时car设备使用app.json5公共区域配置的属性值。")],-1),tn=n("tr",null,[n("td",null,"phone"),n("td",null,"标识对phone设备做的特殊配置，可以配置的属性字段有上文提到的：minAPIVersion、distributedNotificationEnabled。如果使用该属性对phone设备做了特殊配置，则应用在phone设备中会采用此处配置的属性值，并忽略在app.json5公共区域配置的属性值。"),n("td",null,"对象"),n("td",null,"该标签可缺省，缺省时phone设备使用app.json5公共区域配置的属性值。")],-1),en=e(`<blockquote><p>module.json5文件是Stage模型模块配置文件，用于配置HAP包的配置信息、应用/服务在具体设备上的配置信息以及应用/服务的全局配置信息。 以下是一个示例:</p></blockquote><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;entry&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;entry&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$string:module_desc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mainElement&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EntryAbility&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;deviceTypes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;tv&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;tablet&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;deliveryWithInstall&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;installationFree&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$profile:main_pages&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;virtualMachine&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ark&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$profile:distributionFilter_config&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;abilities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EntryAbility&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;srcEntry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./ets/entryability/EntryAbility.ts&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$string:EntryAbility_desc&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;icon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$media:icon&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$string:EntryAbility_label&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;startWindowIcon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$media:icon&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;startWindowBackground&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$color:start_window_background&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;exported&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skills&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;entities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;entity.system.home&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;ohos.want.action.home&quot;</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;requestPermissions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ohos.abilitydemo.permission.PROVIDER&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$string:reason&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;usedScene&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;abilities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;FormAbility&quot;</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token property">&quot;when&quot;</span><span class="token operator">:</span> <span class="token string">&quot;inuse&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),on=n("thead",null,[n("tr",null,[n("th",null,"属性名称"),n("th",null,"含义"),n("th",null,"数据类型"),n("th",null,"是否可缺省")])],-1),ln=n("tr",null,[n("td",null,"name"),n("td",null,"标识当前Module的名称，标签值采用字符串表示（最大长度31个字节），该名称在整个应用要唯一，仅支持英文字符。"),n("td",null,"字符串"),n("td",null,"该标签不可缺省。")],-1),pn=n("tr",null,[n("td",null,"type"),n("td",null,"标识当前Module的类型。类型有两种，分别：- entry：应用的主模块。- feature：应用的动态特性模块。-har：静态共享包模块。-shared：动态共享包模块。"),n("td",null,"字符串"),n("td",null,"该标签不可缺省。")],-1),cn=n("tr",null,[n("td",null,"srcEntry"),n("td",null,"标识当前Module所对应的代码路径，标签值为字符串（最长为127字节）。"),n("td",null,"字符串"),n("td",null,"该标签可缺省，缺省值为空。")],-1),un=n("tr",null,[n("td",null,"description"),n("td",null,"标识当前Module的描述信息，标签值是字符串类型（最长255字节）或对描述内容的字符串资源索引。"),n("td",null,"字符串"),n("td",null,"该标签可缺省，缺省值为空。")],-1),rn=n("tr",null,[n("td",null,"process"),n("td",null,[s("标识当前Module的进程名，标签值为字符串类型（最长为31个字节）。如果在HAP标签下配置了process，该应用的所有UIAbility、DataShareExtensionAbility、ServiceExtensionAbility都运行在该进程中。"),n("strong",null,"说明："),s("- 仅支持系统应用配置，三方应用配置不生效。")]),n("td",null,"字符串"),n("td",null,"可缺省，缺省为app.json5文件下app标签下的bundleName。")],-1),dn=n("tr",null,[n("td",null,"mainElement"),n("td",null,"标识当前Module的入口UIAbility名称或者ExtensionAbility名称。标签最大字节长度为255。"),n("td",null,"字符串"),n("td",null,"该标签可缺省，缺省值为空。")],-1),kn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__devicetypes%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},mn=n("td",null,"标识当前Module可以运行在哪类设备上，标签值采用字符串数组的表示。",-1),bn=n("td",null,"字符串数组",-1),vn=n("td",null,"该标签不可缺省。",-1),hn=n("tr",null,[n("td",null,"deliveryWithInstall"),n("td",null,"标识当前Module是否在用户主动安装的时候安装，表示该Module对应的HAP是否跟随应用一起安装。- true：主动安装时安装。- false：主动安装时不安装。"),n("td",null,"布尔值"),n("td",null,"该标签不可缺省。")],-1),_n=n("tr",null,[n("td",null,"installationFree"),n("td",null,[s("标识当前Module是否支持免安装特性。- true：表示支持免安装特性，且符合免安装约束。- false：表示不支持免安装特性。"),n("strong",null,"说明："),s("- 当应用的entry类型Module的该字段配置为true时，该应用的feature类型的该字段也需要配置为true。- 当应用的entry类型Module的该字段配置为false时，该应用的feature类型的该字段根据业务需求配置true或false。")]),n("td",null,"布尔值"),n("td",null,"该标签不可缺省。")],-1),gn=n("tr",null,[n("td",null,"virtualMachine"),n("td",null,"标识当前Module运行的目标虚拟机类型，供云端分发使用，如应用市场和分发中心。该标签值为字符串。如果目标虚拟机类型为ArkTS引擎，则其值为“ark+版本号”。"),n("td",null,"字符串"),n("td",null,"该标签由IDE构建HAP的时候自动插入。")],-1),yn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__pages%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},fn=n("td",null,"标识当前Module的profile资源，用于列举每个页面信息。该标签最大长度为255个字节。",-1),An=n("td",null,"字符串",-1),qn=n("td",null,"在有UIAbility的场景下，该标签不可缺省。",-1),wn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__metadata%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},In=n("td",null,"标识当前Module的自定义元信息，标签值为数组类型，只对当前Module、UIAbility、ExtensionAbility生效。",-1),Vn=n("td",null,"对象数组",-1),Cn=n("td",null,"该标签可缺省，缺省值为空。",-1),En={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__abilities%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},Un=n("td",null,"标识当前Module中UIAbility的配置信息，标签值为数组类型，只对当前UIAbility生效。",-1),xn=n("td",null,"对象",-1),Pn=n("td",null,"该标签可缺省，缺省值为空。",-1),jn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__extensionabilities%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},Tn=n("td",null,"标识当前Module中ExtensionAbility的配置信息，标签值为数组类型，只对当前ExtensionAbility生效。",-1),Sn=n("td",null,"对象",-1),Nn=n("td",null,"该标签可缺省，缺省值为空。",-1),Bn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__requestpermissions%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},Hn=n("td",null,"标识当前应用运行时需向系统申请的权限集合。",-1),Mn=n("td",null,"对象",-1),Fn=n("td",null,"该标签可缺省，缺省值为空。",-1),Dn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2#ZH-CN_TOPIC_0000001573929365__testrunner%E6%A0%87%E7%AD%BE",target:"_blank",rel:"noopener noreferrer"},On=n("td",null,"标识当前Module用于支持对测试框架的配置。",-1),Zn=n("td",null,"对象",-1),Kn=n("td",null,"该标签可缺省，缺省值为空。",-1),Wn=e('<blockquote><p>详细可以查阅 https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2</p></blockquote><h2 id="生命周期" tabindex="-1"><a class="header-anchor" href="#生命周期" aria-hidden="true">#</a> 生命周期</h2><h3 id="uiability组件生命周期" tabindex="-1"><a class="header-anchor" href="#uiability组件生命周期" aria-hidden="true">#</a> UIAbility组件生命周期</h3><p>https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/uiability-lifecycle-0000001427902208-V2</p><figure><img src="https://qiniu.waite.wang/202404272145594.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://qiniu.waite.wang/202404272203694.png" alt="image-20240427220332385" tabindex="0" loading="lazy"><figcaption>image-20240427220332385</figcaption></figure><blockquote><p>src/main/ets/entryability/EntryAbility.ts</p></blockquote><p>Foreground和Background状态分别在UIAbility实例切换至前台和切换至后台时触发，对应于onForeground()回调和onBackground()回调。</p><p>onForeground()回调，在UIAbility的UI界面可见之前，如UIAbility切换至前台时触发。可以在onForeground()回调中申请系统需要的资源，或者重新申请在onBackground()中释放的资源。</p><p>onBackground()回调，在UIAbility的UI界面完全不可见之后，如UIAbility切换至后台时候触发。可以在onBackground()回调中释放UI界面不可见时无用的资源，或者在此回调中执行较为耗时的操作，例如状态保存等。</p><p>例如应用在使用过程中需要使用用户定位时，假设应用已获得用户的定位权限授权。在UI界面显示之前，可以在onForeground()回调中开启定位功能，从而获取到当前的位置信息。</p><p>当应用切换到后台状态，可以在onBackground()回调中停止定位功能，以节省系统的资源消耗。</p><h3 id="页面和组件的生命周期" tabindex="-1"><a class="header-anchor" href="#页面和组件的生命周期" aria-hidden="true">#</a> 页面和组件的生命周期</h3><p>https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/arkts-page-custom-components-lifecycle-0000001524296665-V2</p><p>在开始之前，我们先明确自定义组件和页面的关系：</p>',15),zn=n("li",null,"自定义组件：@Component装饰的UI单元，可以组合多个系统组件实现UI的复用，可以调用组件的生命周期。",-1),$n={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/arkts-create-custom-components-0000001473537046-V2#section1430055924816",target:"_blank",rel:"noopener noreferrer"},Rn=n("p",null,"页面生命周期，即被@Entry装饰的组件生命周期，提供以下生命周期接口：",-1),Ln={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/arkts-custom-component-lifecycle-0000001482395076-V2#ZH-CN_TOPIC_0000001523488850__onpageshow",target:"_blank",rel:"noopener noreferrer"},Gn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/arkts-custom-component-lifecycle-0000001482395076-V2#ZH-CN_TOPIC_0000001523488850__onpagehide",target:"_blank",rel:"noopener noreferrer"},Jn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/arkts-custom-component-lifecycle-0000001482395076-V2#ZH-CN_TOPIC_0000001523488850__onbackpress",target:"_blank",rel:"noopener noreferrer"},Qn=n("p",null,"组件生命周期，即一般用@Component装饰的自定义组件的生命周期，提供以下生命周期接口：",-1),Xn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/arkts-custom-component-lifecycle-0000001482395076-V2#ZH-CN_TOPIC_0000001523488850__abouttoappear",target:"_blank",rel:"noopener noreferrer"},Yn={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/arkts-custom-component-lifecycle-0000001482395076-V2#ZH-CN_TOPIC_0000001523488850__abouttodisappear",target:"_blank",rel:"noopener noreferrer"},ns=e(`<p>生命周期流程如下图所示，下图展示的是被@Entry装饰的组件（页面）生命周期。</p><figure><img src="https://qiniu.waite.wang/202404272209682.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://qiniu.waite.wang/202404272220757.png" alt="image-20240427222009106" tabindex="0" loading="lazy"><figcaption>image-20240427222009106</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// Index.ets</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&#39;@ohos.router&#39;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Entry</span></span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span>
struct MyComponent <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">State</span></span> showChild<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  <span class="token comment">// 只有被@Entry装饰的组件才可以调用页面的生命周期</span>
  <span class="token function">onPageShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;Index onPageShow&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 只有被@Entry装饰的组件才可以调用页面的生命周期</span>
  <span class="token function">onPageHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;Index onPageHide&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 只有被@Entry装饰的组件才可以调用页面的生命周期</span>
  <span class="token function">onBackPress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;Index onBackPress&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 组件生命周期</span>
  <span class="token function">aboutToAppear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;MyComponent aboutToAppear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 组件生命周期</span>
  <span class="token function">aboutToDisappear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;MyComponent aboutToDisappear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// this.showChild为true，创建Child子组件，执行Child aboutToAppear</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>showChild<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// this.showChild为false，删除Child子组件，执行Child aboutToDisappear</span>
      <span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">&#39;delete Child&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showChild <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// push到Page2页面，执行onPageHide</span>
      <span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">&#39;push to next page&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          router<span class="token punctuation">.</span><span class="token function">pushUrl</span><span class="token punctuation">(</span><span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">&#39;pages/Second&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span>
struct Child <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">State</span></span> title<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#39;Hello World&#39;</span><span class="token punctuation">;</span>
  <span class="token comment">// 组件生命周期</span>
  <span class="token function">aboutToDisappear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;[lifeCycle] Child aboutToDisappear&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 组件生命周期</span>
  <span class="token function">aboutToAppear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;[lifeCycle] Child aboutToAppear&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Text</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fontSize</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;Hello ArkUI&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://qiniu.waite.wang/202404272230907.png" alt="image-20240427223013370" tabindex="0" loading="lazy"><figcaption>image-20240427223013370</figcaption></figure><h2 id="uiability组件启动模式" tabindex="-1"><a class="header-anchor" href="#uiability组件启动模式" aria-hidden="true">#</a> UIAbility组件启动模式</h2><blockquote><p>具体重新观看: https://www.bilibili.com/video/BV1Sa4y1Z7B1/?p=27</p></blockquote><p>https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/uiability-launch-type-0000001428061476-V2</p><p>UIAbility的启动模式是指UIAbility实例在启动时的不同呈现状态。针对不同的业务场景，系统提供了三种启动模式：</p>`,9),ss={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/uiability-launch-type-0000001428061476-V2#ZH-CN_TOPIC_0000001523489150__singleton%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"},as={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/uiability-launch-type-0000001428061476-V2#ZH-CN_TOPIC_0000001523489150__standard%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"},ts={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/uiability-launch-type-0000001428061476-V2#ZH-CN_TOPIC_0000001523489150__specified%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"},es=e('<h2 id="singleton启动模式" tabindex="-1"><a class="header-anchor" href="#singleton启动模式" aria-hidden="true">#</a> singleton启动模式</h2><p>singleton启动模式为单实例模式，也是默认情况下的启动模式。</p><p>每次调用startAbility()方法时，如果应用进程中该类型的UIAbility实例已经存在，则复用系统中的UIAbility实例。系统中只存在唯一一个该UIAbility实例，即在最近任务列表中只存在一个该类型的UIAbility实例。</p><p><strong>图1</strong> 单实例模式演示效果</p><figure><img src="https://qiniu.waite.wang/202404272235630.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>说明</p><p>应用的UIAbility实例已创建，该UIAbility配置为单实例模式，再次调用startAbility()方法启动该UIAbility实例，此时只会进入该UIAbility的onNewWant()回调，不会进入其onCreate()和onWindowStageCreate()生命周期回调。</p>',7),os={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2",target:"_blank",rel:"noopener noreferrer"},ls=e(`<div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token property">&quot;abilities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;launchType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;singleton&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="multiton启动模式" tabindex="-1"><a class="header-anchor" href="#multiton启动模式" aria-hidden="true">#</a> multiton启动模式</h4><p>multiton启动模式为多实例模式，每次调用startAbility()方法时，都会在应用进程中创建一个新的该类型UIAbility实例。即在最近任务列表中可以看到有多个该类型的UIAbility实例。这种情况下可以将UIAbility配置为multiton（多实例模式）。</p><p><strong>图2</strong> 多实例模式演示效果</p><figure><img src="https://qiniu.waite.wang/202404272235979.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>`,5),is={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2",target:"_blank",rel:"noopener noreferrer"},ps=e(`<div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token property">&quot;abilities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;launchType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;multiton&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="specified启动模式" tabindex="-1"><a class="header-anchor" href="#specified启动模式" aria-hidden="true">#</a> specified启动模式</h4><p>specified启动模式为指定实例模式，针对一些特殊场景使用（例如文档应用中每次新建文档希望都能新建一个文档实例，重复打开一个已保存的文档希望打开的都是同一个文档实例）。</p><p>在UIAbility实例创建之前，允许开发者为该实例创建一个唯一的字符串Key，创建的UIAbility实例绑定Key之后，后续每次调用startAbility()方法时，都会询问应用使用哪个Key对应的UIAbility实例来响应startAbility()请求。运行时由UIAbility内部业务决定是否创建多实例，如果匹配有该UIAbility实例的Key，则直接拉起与之绑定的UIAbility实例，否则创建一个新的UIAbility实例。</p><p><strong>图3</strong> 指定实例模式演示效果</p><figure><img src="https://qiniu.waite.wang/202404272236549.png" alt="点击放大" tabindex="0" loading="lazy"><figcaption>点击放大</figcaption></figure>`,6),cs={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/abilitystage-0000001427584604-V2",target:"_blank",rel:"noopener noreferrer"},us={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/js-apis-app-ability-abilitystage-0000001493424312-V2#ZH-CN_TOPIC_0000001574088265__abilitystageonacceptwant",target:"_blank",rel:"noopener noreferrer"},rs={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/js-apis-app-ability-uiability-0000001493584184-V2#ZH-CN_TOPIC_0000001523808838__abilityonnewwant",target:"_blank",rel:"noopener noreferrer"},ds=n("p",null,"例如有两个UIAbility：EntryAbility和FuncAbility，FuncAbility配置为specified启动模式，需要从EntryAbility的页面中启动FuncAbility。",-1),ks={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/module-configuration-file-0000001427744540-V2",target:"_blank",rel:"noopener noreferrer"},ms=e(`<div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token property">&quot;abilities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;launchType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;specified&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),bs=e(`<li><p>在EntryAbility中，调用startAbility()方法时，在want参数中，增加一个自定义参数来区别UIAbility实例，例如增加一个&quot;instanceKey&quot;自定义参数。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 在启动指定实例模式的UIAbility时，给每一个UIAbility实例配置一个独立的Key标识</span>
<span class="token comment">// 例如在文档使用场景中，可以用文档路径作为Key标识</span>
<span class="token keyword">function</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> want <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">deviceId</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// deviceId为空表示本设备</span>
    <span class="token literal-property property">bundleName</span><span class="token operator">:</span> <span class="token string">&#39;com.example.myapplication&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">abilityName</span><span class="token operator">:</span> <span class="token string">&#39;FuncAbility&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">moduleName</span><span class="token operator">:</span> <span class="token string">&#39;module1&#39;</span><span class="token punctuation">,</span> <span class="token comment">// moduleName非必选</span>
    <span class="token literal-property property">parameters</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 自定义信息</span>
        <span class="token literal-property property">instanceKey</span><span class="token operator">:</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// context为调用方UIAbility的AbilityContext</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">startAbility</span><span class="token punctuation">(</span>want<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,1),vs={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/js-apis-app-ability-abilitystage-0000001493424312-V2#ZH-CN_TOPIC_0000001574088265__abilitystageonacceptwant",target:"_blank",rel:"noopener noreferrer"},hs={href:"https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V2/js-apis-app-ability-abilitystage-0000001493424312-V2#ZH-CN_TOPIC_0000001574088265__abilitystageonacceptwant",target:"_blank",rel:"noopener noreferrer"},_s=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> AbilityStage <span class="token keyword">from</span> <span class="token string">&#39;@ohos.app.ability.AbilityStage&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyAbilityStage</span> <span class="token keyword">extends</span> <span class="token class-name">AbilityStage</span> <span class="token punctuation">{</span>
    <span class="token function">onAcceptWant</span><span class="token punctuation">(</span>want<span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
        <span class="token comment">// 在被调用方的AbilityStage中，针对启动模式为specified的UIAbility返回一个UIAbility实例对应的一个Key值</span>
        <span class="token comment">// 当前示例指的是module1 Module的FuncAbility</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>want<span class="token punctuation">.</span>abilityName <span class="token operator">===</span> <span class="token string">&#39;FuncAbility&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 返回的字符串Key标识为自定义拼接的字符串内容</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">ControlModule_EntryAbilityInstance_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>want<span class="token punctuation">.</span>parameters<span class="token punctuation">.</span>instanceKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>例如在文档应用中，可以对不同的文档实例内容绑定不同的Key值。当每次新建文档的时候，可以传入不同的新Key值（如可以将文件的路径作为一个Key标识），此时AbilityStage中启动UIAbility时都会创建一个新的UIAbility实例；当新建的文档保存之后，回到桌面，或者新打开一个已保存的文档，回到桌面，此时再次打开该已保存的文档，此时AbilityStage中再次启动该UIAbility时，打开的仍然是之前原来已保存的文档界面。</p><p>以如下步骤所示进行举例说明。</p><ol><li>打开文件A，对应启动一个新的UIAbility实例，例如启动“UIAbility实例1”。</li><li>在最近任务列表中关闭文件A的进程，此时UIAbility实例1被销毁，回到桌面，再次打开文件A，此时对应启动一个新的UIAbility实例，例如启动“UIAbility实例2”。</li><li>回到桌面，打开文件B，此时对应启动一个新的UIAbility实例，例如启动“UIAbility实例3”。</li><li>回到桌面，再次打开文件A，此时对应启动的还是之前的“UIAbility实例2”。</li></ol>`,4);function gs(ys,fs){const a=l("ExternalLinkIcon");return i(),p("div",null,[u,r,d,k,m,n("ul",null,[b,n("li",null,[s("entry：HarmonyOS工程模块，编译构建生成一个HAP包。 "),n("ul",null,[v,h,_,n("li",null,[s("src > main > module.json5：Stage模型模块配置文件。主要包含HAP包的配置信息、应用/服务在具体设备上的配置信息以及应用/服务的全局配置信息。具体的配置文件说明，详见"),n("a",g,[s("module.json5配置文件"),t(a)]),s("。")]),y,f])]),A,q,w]),I,V,C,E,n("table",null,[U,n("tbody",null,[x,P,j,n("tr",null,[T,n("td",null,[s("标识"),n("a",S,[s("应用的图标"),t(a)]),s("，标签值为图标资源文件的索引。")]),N,B]),n("tr",null,[H,n("td",null,[s("标识"),n("a",M,[s("应用的名称"),t(a)]),s("，标签值为字符串资源的索引。")]),F,D]),O,Z,K,W,z,$,R,L,n("tr",null,[G,n("td",null,[s("标识当前工程是否支持多个工程的联合开发。- true：当前工程支持多个工程的联合开发。- false：当前工程不支持多个工程的联合开发。多工程开发可以参考文档："),n("a",J,[s("多工程构建"),t(a)]),s("。")]),Q,X]),Y,nn,sn,an,tn])]),en,n("table",null,[on,n("tbody",null,[ln,pn,cn,un,rn,dn,n("tr",null,[n("td",null,[n("a",kn,[s("deviceTypes"),t(a)])]),mn,bn,vn]),hn,_n,gn,n("tr",null,[n("td",null,[n("a",yn,[s("pages"),t(a)])]),fn,An,qn]),n("tr",null,[n("td",null,[n("a",wn,[s("metadata"),t(a)])]),In,Vn,Cn]),n("tr",null,[n("td",null,[n("a",En,[s("abilities"),t(a)])]),Un,xn,Pn]),n("tr",null,[n("td",null,[n("a",jn,[s("extensionAbilities"),t(a)])]),Tn,Sn,Nn]),n("tr",null,[n("td",null,[n("a",Bn,[s("requestPermissions"),t(a)])]),Hn,Mn,Fn]),n("tr",null,[n("td",null,[n("a",Dn,[s("testRunner"),t(a)])]),On,Zn,Kn])])]),Wn,n("ul",null,[zn,n("li",null,[s("页面：即应用的UI页面。可以由一个或者多个自定义组件组成，"),n("a",$n,[s("@Entry"),t(a)]),s("装饰的自定义组件为页面的入口组件，即页面的根节点，一个页面有且仅能有一个@Entry。只有被@Entry装饰的组件才可以调用页面的生命周期。")])]),Rn,n("ul",null,[n("li",null,[n("a",Ln,[s("onPageShow"),t(a)]),s("：页面每次显示时触发一次，包括路由过程、应用进入前台等场景。")]),n("li",null,[n("a",Gn,[s("onPageHide"),t(a)]),s("：页面每次隐藏时触发一次，包括路由过程、应用进入后台等场景。")]),n("li",null,[n("a",Jn,[s("onBackPress"),t(a)]),s("：当用户点击返回按钮时触发。")])]),Qn,n("ul",null,[n("li",null,[n("a",Xn,[s("aboutToAppear"),t(a)]),s("：组件即将出现时回调该接口，具体时机为在创建自定义组件的新实例后，在执行其build()函数之前执行。")]),n("li",null,[n("a",Yn,[s("aboutToDisappear"),t(a)]),s("：在自定义组件析构销毁之前执行。不允许在aboutToDisappear函数中改变状态变量，特别是@Link变量的修改可能会导致应用程序行为不稳定。")])]),ns,n("ul",null,[n("li",null,[n("a",ss,[s("singleton（单实例模式）"),t(a)])]),n("li",null,[n("a",as,[s("multiton（多实例模式）"),t(a)])]),n("li",null,[n("a",ts,[s("specified（指定实例模式）"),t(a)])])]),es,n("p",null,[s("如果需要使用singleton启动模式，在"),n("a",os,[s("module.json5配置文件"),t(a)]),s('中的"launchType"字段配置为"singleton"即可。')]),ls,n("p",null,[s("multiton启动模式的开发使用，在"),n("a",is,[s("module.json5配置文件"),t(a)]),s('中的"launchType"字段配置为"multiton"即可。')]),ps,n("p",null,[s("应用的UIAbility实例已创建，该UIAbility配置为指定实例模式，再次调用startAbility()方法启动该UIAbility实例，且"),n("a",cs,[s("AbilityStage"),t(a)]),s("的"),n("a",us,[s("onAcceptWant()"),t(a)]),s("回调匹配到一个已创建的UIAbility实例。此时，再次启动该UIAbility时，只会进入该UIAbility的"),n("a",rs,[s("onNewWant()"),t(a)]),s("回调，不会进入其onCreate()和onWindowStageCreate()生命周期回调。")]),ds,n("ol",null,[n("li",null,[n("p",null,[s("在FuncAbility中，将"),n("a",ks,[s("module.json5配置文件"),t(a)]),s('的"launchType"字段配置为"specified"。')]),ms]),bs,n("li",null,[n("p",null,[s("由于FuncAbility的启动模式配置为了指定实例启动模式，在FuncAbility启动之前，会先进入其对应的AbilityStage的"),n("a",vs,[s("onAcceptWant()"),t(a)]),s('生命周期回调中，解析传入的want参数，获取"instanceKey"自定义参数。根据业务需要通过AbilityStage的'),n("a",hs,[s("onAcceptWant()"),t(a)]),s("生命周期回调返回一个字符串Key标识。如果返回的Key对应一个已启动的UIAbility，则会将之前的UIAbility拉回前台并获焦，而不创建新的实例，否则创建新的实例并启动。")]),_s])])])}const ws=o(c,[["render",gs],["__file","Stage模型.html.vue"]]);export{ws as default};
